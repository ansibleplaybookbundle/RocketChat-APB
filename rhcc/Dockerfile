FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJvY2tldGNoYXQtcmgtYXBiCmltYWdlOiBvcGVuc2hpZnQzL3Jv\
Y2tldGNoYXQtcmgtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIEFQQiBkZXBsb3lzIFJvY2tldENoYXQg\
YmFja2VkIGJ5IE1vbmdvREIKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0\
YTogCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly9yb2NrZXQuY2hhdAogIGltYWdlVXJsOiBo\
dHRwczovL2dpdGh1Yi5jb20vUm9ja2V0Q2hhdC9Sb2NrZXQuQ2hhdC5BcnR3b3JrL2Jsb2IvbWFz\
dGVyL0xvZ29zL3JvY2tldGNhdC5wbmc/cmF3PXRydWUKICBkZXBlbmRlbmNpZXM6IFsncmVnaXN0\
cnkuY29ubmVjdC5yZWRoYXQuY29tL3JvY2tldGNoYXQvcm9ja2V0Y2hhdDpsYXRlc3QnLCAncmVn\
aXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvbW9uZ29kYi0zMi1yaGVsNyddCiAgZGlzcGxh\
eU5hbWU6IFJvY2tldENoYXQgUkggKEFQQikKICBsb25nRGVzY3JpcHRpb246IEFuIEFQQiB0aGF0\
IGRlcGxveXMgUm9ja2V0Q2hhdCB0byBPcGVuU2hpZnQgYmFja2VkIGJ5IE1vbmdvREIKICBwcm92\
aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0\
CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYSBzaW5nbGUgUm9ja2V0Q2hhdCBh\
cHBsaWNhdGlvbiBiYWNrZWQgYnkgTW9uZ29EQgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6\
CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBw\
bGFuIHByb3ZpZGVzIGEgUm9ja2V0Q2hhdCBhcHBsaWNhdGlvbiBiYWNrZWQgYnkgTW9uZ29EQgog\
ICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogCiAgICAgIC0gbmFtZTogbW9uZ29kYl91\
c2VyCiAgICAgICAgZGVmYXVsdDogcm9ja2V0Y2hhdAogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHRpdGxlOiBNb25nb0RCIFVzZXJuYW1lCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAg\
LSBuYW1lOiBtb25nb2RiX3Bhc3MKICAgICAgICBkZWZhdWx0OiBjaGFuZ2VtZQogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNb25nb0RCIFBhc3N3b3JkCiAgICAgICAgcmVxdWly\
ZWQ6IFRydWUKICAgICAgLSBuYW1lOiBtb25nb2RiX25hbWUKICAgICAgICBkZWZhdWx0OiByb2Nr\
ZXRjaGF0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE1vbmdvREIgRGF0YWJh\
c2UgTmFtZQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIC0gbmFtZTogbW9uZ29kYl9hZG1p\
bl9wYXNzCiAgICAgICAgZGVmYXVsdDogY2hhbmdlbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICB0aXRsZTogTW9uZ29EQiBBZG1pbiBQYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiBUcnVl\
CiAgICAgIC0gbmFtZTogbW9uZ29kYl92ZXJzaW9uCiAgICAgICAgZGVmYXVsdDogIjMuMiIKICAg\
ICAgICBlbnVtOiBbJzMuMicsICcyLjYnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRs\
ZTogTW9uZ29EQiBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBy\
b2NrZXRjaGF0X3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiBsYXRlc3QKICAgICAgICBlbnVtOiBb\
J2xhdGVzdCcsICcwLjU2LjAnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRsZTogUm9j\
a2V0Q2hhdCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb

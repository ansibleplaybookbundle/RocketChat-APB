FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJvY2tldGNoYXQtYXBiCmltYWdlOiBhbnNpYmxlcGxheWJvb2ti\
dW5kbGUvcm9ja2V0Y2hhdC1hcGIKZGVzY3JpcHRpb246IFRoaXMgQVBCIGRlcGxveXMgUm9ja2V0\
Q2hhdCBiYWNrZWQgYnkgTW9uZ29EQgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1l\
dGFkYXRhOiAKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL3JvY2tldC5jaGF0CiAgaW1hZ2VV\
cmw6IGh0dHBzOi8vZ2l0aHViLmNvbS9Sb2NrZXRDaGF0L1JvY2tldC5DaGF0LkFydHdvcmsvYmxv\
Yi9tYXN0ZXIvTG9nb3Mvcm9ja2V0Y2F0LnBuZz9yYXc9dHJ1ZQogIGRlcGVuZGVuY2llczogWydy\
b2NrZXQuY2hhdDpsYXRlc3QnLCAnbW9uZ286My4yJ10KICBkaXNwbGF5TmFtZTogUm9ja2V0Q2hh\
dCAoQVBCKQogIGxvbmdEZXNjcmlwdGlvbjogQW4gQVBCIHRoYXQgZGVwbG95cyBSb2NrZXRDaGF0\
IHRvIE9wZW5TaGlmdCBiYWNrZWQgYnkgTW9uZ29EQgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJS\
ZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBU\
aGlzIHBsYW4gZGVwbG95cyBhIHNpbmdsZSBSb2NrZXRDaGF0IGFwcGxpY2F0aW9uIGJhY2tlZCBi\
eSBNb25nb0RCCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6\
IERlZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMgYSBSb2Nr\
ZXRDaGF0IGFwcGxpY2F0aW9uIGJhY2tlZCBieSBNb25nb0RCCiAgICAgIGNvc3Q6ICQwLjAwCiAg\
ICBwYXJhbWV0ZXJzOiAKICAgICAgLSBuYW1lOiBtb25nb2RiX3VzZXIKICAgICAgICBkZWZhdWx0\
OiByb2NrZXRjaGF0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE1vbmdvREIg\
VXNlcm5hbWUKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAtIG5hbWU6IG1vbmdvZGJfcGFz\
cwogICAgICAgIGRlZmF1bHQ6IGNoYW5nZW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
dGl0bGU6IE1vbmdvREIgUGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAtIG5h\
bWU6IG1vbmdvZGJfbmFtZQogICAgICAgIGRlZmF1bHQ6IHJvY2tldGNoYXQKICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICB0aXRsZTogTW9uZ29EQiBEYXRhYmFzZSBOYW1lCiAgICAgICAgcmVx\
dWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBtb25nb2RiX2FkbWluX3Bhc3MKICAgICAgICBkZWZh\
dWx0OiBjaGFuZ2VtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNb25nb0RC\
IEFkbWluIFBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBtb25n\
b2RiX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAiMy4yIgogICAgICAgIGVudW06IFsnMy4yJywg\
JzMuNCcsICczLjUnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRsZTogTW9uZ29EQiBW\
ZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiByb2NrZXRjaGF0X3Zl\
cnNpb24KICAgICAgICBkZWZhdWx0OiBsYXRlc3QKICAgICAgICBlbnVtOiBbJ2xhdGVzdCcsICcw\
LjU2LjAnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRsZTogUm9ja2V0Q2hhdCBWZXJz\
aW9uCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
